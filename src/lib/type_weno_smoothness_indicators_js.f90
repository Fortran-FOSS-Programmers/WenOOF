module type_weno_smoothness_indicators_js
!-----------------------------------------------------------------------------------------------------------------------------------
!< Module providing Jiang-Shu and Gerolymos-Sénéchal-Vallet smoothness indicators for WENO schemes.
!<
!< @note The provided WENO optimal weights implements the smoothness indicators defined in *Efficient Implementation
!< of Weighted ENO Schemes*, Guang-Shan Jiang, Chi-Wang Shu, JCP, 1996, vol. 126, pp. 202--228, doi:10.1006/jcph.1996.0130 and
!< *Very-high-order weno schemes*, G. A. Gerolymos, D. Sénéchal, I. Vallet, JCP, 2009, vol. 228, pp. 8481-8524,
!< doi:10.1016/j.jcp.2009.07.039
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
use penf, only : I_P, R_P
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
implicit none
private
save
public :: weno_IS_js
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
type, extends(weno_IS) :: weno_IS_js
  !< Jiang-Shu and Gerolymos-Sénéchal-Vallet WENO smoothness indicators object.
  !<
  !< @note The provided WENO optimal weights implements the optimal weights defined in *Efficient Implementation of Weighted ENO
  !< Schemes*, Guang-Shan Jiang, Chi-Wang Shu, JCP, 1996, vol. 126, pp. 202--228, doi:10.1006/jcph.1996.0130 and
  !< *Very-high-order weno schemes*, G. A. Gerolymos, D. Sénéchal, I. Vallet, JCP, 2009, vol. 228, pp. 8481-8524,
  !< doi:10.1016/j.jcp.2009.07.039
  private
  real(R_P), allocatable :: coef(:,:)   !< Optimal weights [1:2,0:S-1].
  contains
    procedure(destructor_interface),  pass(self), deferred, public :: destroy
    procedure(constructor_interface), pass(self), deferred, public :: create
    procedure(description_interface), pass(self), deferred, public :: description
    procedure(compute_interface),     pass(self), deferred, public :: compute
endtype weno_IS_js
!-----------------------------------------------------------------------------------------------------------------------------------
contains
  ! deferred public methods
  pure subroutine destroy(self)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Destroy Jiang-Shu and Gerolymos-Sénéchal-Vallet WENO smoothness indicators coefficients.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(weno_IS_js), intent(inout) :: self   !< WENO smoothenss indicators.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  if (allocated(self%coef)) deallocate(self%coef)
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endsubroutine destroy

  pure subroutine create(self, S)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Create WENO smoothness indicators coefficients.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(weno_IS_js), intent(inout) :: self       !< WENO smoothness indicators.
  integer(I_P),      intent(in)    :: S          !< Number of stencils used.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  call self%destroy
  associate(c => self%coef)
    allocate(c(1:2, 0:S - 1))
    select case(S)
    case(2) ! 3rd order
      ! stencil 0
      !       i*i      ;     (i-1)*i
      c(0,0,0) = 1._R_P; c(1,0,0) = -2._R_P
      !      /         ;     (i-1)*(i-1)
      c(0,1,0) = 0._R_P; c(1,1,0) =  1._R_P
      ! stencil 1
      !  (i+1)*(i+1)   ;     (i+1)*i
      c(0,0,1) = 1._R_P; c(1,0,1) = -2._R_P
      !      /         ;      i*i
      c(0,1,1) = 0._R_P; c(1,1,1) =  1._R_P
    case(3) ! 5th order
      ! stencil 0
      !      i*i                ;       (i-1)*i             ;       (i-2)*i
      c(0,0,0) =  10._R_P/3._R_P; c(1,0,0) = -31._R_P/3._R_P; c(2,0 0) =  11._R_P/3._R_P
      !      /                  ;       (i-1)*(i-1)         ;       (i-2)*(i-1)
      c(0,1,0) =   0._R_P       ; c(1,1,0) =  25._R_P/3._R_P; c(2,1,0) = -19._R_P/3._R_P
      !      /                  ;        /                  ;       (i-2)*(i-2)
      c(0,2,0) =   0._R_P       ; c(1,2,0) =   0._R_P       ; c(2,2,0) =   4._R_P/3._R_P
      ! stencil 1
      !     (i+1)*(i+1)         ;        i*(i+1)            ;       (i-1)*(i+1)
      c(0,0,1) =   4._R_P/3._R_P; c(1,0,1) = -13._R_P/3._R_P; c(2,0,1) =   5._R_P/3._R_P
      !      /                  ;        i*i                ;       (i-1)*i
      c(0,1,1) =   0._R_P       ; c(1,1,1) =  13._R_P/3._R_P; c(2,1,1) = -13._R_P/3._R_P
      !      /                  ;        /                  ;       (i-1)*(i-1)
      c(0,2,1) =   0._R_P       ; c(1,2,1) =   0._R_P       ; c(2,2,1) =   4._R_P/3._R_P
      ! stencil 2
      !     (i+2)*(i+2)         ;       (i+1)*(i+2)         ;        i*(i+2)
      c(0,0,2) =   4._R_P/3._R_P; c(1,0,2) = -19._R_P/3._R_P; c(2,0,2) =  11._R_P/3._R_P
      !      /                  ;       (i+1)*(i+1)         ;        i*(i+1)
      c(0,1,2) =   0._R_P       ; c(1,1,2) =  25._R_P/3._R_P; c(2,1,2) = -31._R_P/3._R_P
      !      /                  ;        /                  ;        i*i
      c(0,2,2) =   0._R_P       ; c(1,2,2) =   0._R_P       ; c(2,2,2) =  10._R_P/3._R_P
    case(4) ! 7th order
      ! stencil 0
      !      i*i           ;       (i-1)*i        ;       (i-2)*i         ;       (i-3)*i
      c(0,0,0) = 2107._R_P ; c(1,0,0) =-9402._R_P ; c(2,0,0) =  7042._R_P ; c(3,0,0) = -1854._R_P
      !      /             ;       (i-1)*(i-1)    ;       (i-2)*(i-1)     ;       (i-3)*(i-1)
      c(0,1,0) =    0._R_P ; c(1,1,0) =11003._R_P ; c(2,1,0) =-17246._R_P ; c(3,1,0) =  4642._R_P
      !      /             ;        /             ;       (i-2)*(i-2)     ;       (i-3)*(i-2)
      c(0,2,0) =    0._R_P ; c(1,2,0) =    0._R_P ; c(2,2,0) =  7043._R_P ; c(3,2,0) = -3882._R_P
      !      /             ;        /             ;        /              ;       (i-3)*(i-3)
      c(0,3,0) =    0._R_P ; c(1,3,0) =    0._R_P ; c(2,3,0) =     0._R_P ; c(3,3,0) =   547._R_P
      ! stencil 1
      !    (i+1)*(i+1)    ;        i*(i+1)      ;       (i-1)*(i+1)    ;       (i-2)*(i+1)
      c(0,0,1) =  547._R_P; c(1,0,1) =-2522._R_P; c(2,0,1) =  1922._R_P; c(3,0,1) =  -494._R_P
      !     /             ;        i*i          ;      (i-1)*i         ;       (i-2)*i
      c(0,1,1) =    0._R_P; c(1,1,1) = 3443._R_P; c(2,1,1) = -5966._R_P; c(3,1,1) =  1602._R_P
      !     /             ;        /            ;      (i-1)*(i-1)     ;       (i-2)*(i-1)
      c(0,2,1) =    0._R_P; c(1,2,1) =    0._R_P; c(2,2,1) =  2843._R_P; c(3,2,1) = -1642._R_P
      !     /             ;        /            ;       /              ;       (i-2)*(i-2)
      c(0,3,1) =    0._R_P; c(1,3,1) =    0._R_P; c(2,3,1) =     0._R_P; c(3,3,1) =   267._R_P
      ! stencil 2
      !     (i+2)*(i+2)   ;     (i+1)*(i+2)     ;       i*(i+2)        ;      (i-1)*(i+2)
      c(0,0,2) =  267._R_P; c(1,0,2) =-1642._R_P; c(2,0,2) =  1602._R_P; c(3,0,2) =  -494._R_P
      !     /             ;     (i+1)*(i+1)     ;       i*(i+1)        ;      (i-1)*(i+1)
      c(0,1,2) =    0._R_P; c(1,1,2) = 2843._R_P; c(2,1,2) = -5966._R_P; c(3,1,2) =  1922._R_P
      !     /             ;       /             ;       i*i            ;      (i-1)*i
      c(0,2,2) =    0._R_P; c(1,2,2) =    0._R_P; c(2,2,2) =  3443._R_P; c(3,2,2) = -2522._R_P
      !     /             ;       /             ;       /              ;      (i-1)*(i-1)
      c(0,3,2) =    0._R_P; c(1,3,2) =    0._R_P; c(2,3,2) =     0._R_P; c(3,3,2) =   547._R_P
      ! stencil 3
      !    (i+3)*(i+3)    ;      (i+2)*(i+3)    ;      (i+1)*(i+3)     ;       i*(i+3)
      c(0,0,3) =  547._R_P; c(1,0,3) =-3882._R_P; c(2,0,3) =  4642._R_P; c(3,0,3) = -1854._R_P
      !     /             ;      (i+2)*(i+2)    ;      (i+1)*(i+2)     ;       i*(i+2)
      c(0,1,3) =    0._R_P; c(1,1,3) = 7043._R_P; c(2,1,3) =-17246._R_P; c(3,1,3) =  7042._R_P
      !     /             ;       /             ;      (i+1)*(i+1)     ;       i*(i+1)
      c(0,2,3) =    0._R_P; c(1,2,3) =    0._R_P; c(2,2,3) = 11003._R_P; c(3,2,3) = -9402._R_P
      !     /             ;       /             ;       /              ;       i*i
      c(0,3,3) =    0._R_P; c(1,3,3) =    0._R_P; c(2,3,3) =     0._R_P; c(3,3,3) =  2107._R_P
    case(5) ! 9th order
      ! stencil 0
      !        i*i           ;       (i-1)*i          ;       (i-2)*i          ;      (i-3)*i           ;      (i-4)*i
      c(0,0,0) =  107918._R_P; c(1,0,0) = -649501._R_P; c(2,0,0) =  758823._R_P; c(3,0,0) = -411487._R_P; c(4,0,0) =   86329._R_P
      !        /             ;       (i-1)*(i-1)      ;       (i-2)*(i-1)      ;      (i-3)*(i-1)       ;      (i-4)*(i-1)
      c(0,1,0) =       0._R_P; c(1,1,0) = 1020563._R_P; c(2,1,0) =-2462076._R_P; c(3,1,0) = 1358458._R_P; c(4,1,0) = -288007._R_P
      !        /             ;        /               ;       (i-2)*(i-2)      ;      (i-3)*(i-2)       ;      (i-4)*(i-2)
      c(0,2,0) =       0._R_P; c(1,2,0) =       0._R_P; c(2,2,0) = 1521393._R_P; c(3,2,0) =-1704396._R_P; c(4,2,0) =  364863._R_P
      !        /             ;        /               ;        /               ;      (i-3)*(i-3)       ;      (i-4)*(i-3)
      c(0,3,0) =       0._R_P; c(1,3,0) =       0._R_P; c(2,3,0) =       0._R_P; c(3,3,0) =  482963._R_P; c(4,3,0) = -208501._R_P
      !        /             ;        /               ;        /               ;       /                ;      (i-4)*(i-4)
      c(0,4,0) =       0._R_P; c(1,4,0) =       0._R_P; c(2,4,0) =       0._R_P; c(3,4,0) =       0._R_P; c(4,4,0) =   22658._R_P
      ! stencil 1
      !       (i+1)*(i+1)    ;          i*(i+1)       ;        (i-1)*(i+1)     ;        (i-2)*(i+1)     ;      (i-3)*(i+1)
      c(0,0,1) =   22658._R_P; c(1,0,1) = -140251._R_P; c(2,0,1) =  165153._R_P; c(3,0,1) =  -88297._R_P; c(4,0,1) =   18079._R_P
      !         /            ;          i*i           ;        (i-1)*i         ;        (i-2)*i         ;      (i-3)*i
      c(0,1,1) =       0._R_P; c(1,1,1) =  242723._R_P; c(2,1,1) = -611976._R_P; c(3,1,1) =  337018._R_P; c(4,1,1) =  -70237._R_P
      !         /            ;           /            ;        (i-1)*(i-1)     ;        (i-2)*(i-1)     ;      (i-3)*(i-1)
      c(0,2,1) =       0._R_P; c(1,2,1) =       0._R_P; c(2,2,1) =  406293._R_P; c(3,2,1) = -464976._R_P; c(4,2,1) =   99213._R_P
      !         /            ;           /            ;         /              ;        (i-2)*(i-2)     ;      (i-3)*(i-2)
      c(0,3,1) =       0._R_P; c(1,3,1) =       0._R_P; c(2,3,1) =       0._R_P; c(3,3,1) =  138563._R_P; c(4,3,1) =  -60871._R_P
      !        /             ;           /            ;         /              ;         /              ;      (i-3)*(i-3)
      c(0,4,1) =       0._R_P; c(1,4,1) =       0._R_P; c(2,4,1) =       0._R_P; c(3,4,1) =       0._R_P; c(4,4,1) =    6908._R_P
      ! stencil 2
      !       (i+2)*(i+2)    ;       (i+1)*(i+2)      ;       i*(i+2)          ;      (i-1)*(i+2)       ;      (i-2)*(i+2)
      c(0,0,2) =    6908._R_P; c(1,0,2) =  -51001._R_P; c(2,0,2) =   67923._R_P; c(3,0,2) =  -38947._R_P; c(4,0,2) =    8209._R_P
      !        /             ;       (i+1)*(i+1)      ;       i*(i+1)          ;      (i-1)*(i+1)       ;      (i-2)*(i+1)
      c(0,1,2) =       0._R_P; c(1,1,2) =  104963._R_P; c(2,1,2) = -299076._R_P; c(3,1,2) =  179098._R_P; c(4,1,2) =  -38947._R_P
      !        /             ;        /               ;       i*i              ;      (i-1)*i           ;      (i-2)*i
      c(0,2,2) =       0._R_P; c(1,2,2) =       0._R_P; c(2,2,2) =  231153._R_P; c(3,2,2) = -299076._R_P; c(4,2,2) =   67923._R_P
      !        /             ;        /               ;       /                ;      (i-1)*(i-1)       ;      (i-2)*(i-1)
      c(0,3,2) =       0._R_P; c(1,3,2) =       0._R_P; c(2,3,2) =       0._R_P; c(3,3,2) =  138563._R_P; c(4,3,2) =  -60871._R_P
      !        /             ;        /               ;       /                ;       /                ;      (i-2)*(i-2)
      c(0,4,2) =       0._R_P; c(1,4,2) =       0._R_P; c(2,4,2) =       0._R_P; c(3,4,2) =       0._R_P; c(4,4,2) =    6908._R_P
      ! stencil 3
      !       (i+3)*(i+3)    ;       (i+2)*(i+3)      ;      (i+1)*(i+3)       ;       i*(i+3)          ;      (i-1)*(i+3)
      c(0,0,3) =    6908._R_P; c(1,0,3) =  -60871._R_P; c(2,0,3) =   99213._R_P; c(3,0,3) =  -70237._R_P; c(4,0,3) =   18079._R_P
      !        /             ;       (i+2)*(i+2)      ;      (i+1)*(i+2)       ;       i*(i+2)          ;      (i-1)*(i+2)
      c(0,1,3) =       0._R_P; c(1,1,3) =  138563._R_P; c(2,1,3) = -464976._R_P; c(3,1,3) =  337018._R_P; c(4,1,3) =  -88297._R_P
      !        /             ;        /               ;      (i+1)*(i+1)       ;       i*(i+1)          ;      (i-1)*(i+1)
      c(0,2,3) =       0._R_P; c(1,2,3) =       0._R_P; c(2,2,3) =  406293._R_P; c(3,2,3) = -611976._R_P; c(4,2,3) =  165153._R_P
      !        /             ;        /               ;       /                ;       i*i              ;      (i-1)*i
      c(0,3,3) =       0._R_P; c(1,3,3) =       0._R_P; c(2,3,3) =       0._R_P; c(3,3,3) =  242723._R_P; c(4,3,3) = -140251._R_P
      !        /             ;        /               ;       /                ;       /                ;      (i-1)*(i-1)
      c(0,4,0) =       0._R_P; c(1,4,3) =       0._R_P; c(2,4,3) =       0._R_P; c(3,4,0) =       0._R_P; c(4,4,3) =   22658._R_P
      ! stencil 4
      !    (i+4)*(i+4)       ;    (i+3)*(i+4)         ;      (i+2)*(i+4)       ;      (i+1)*(i+4)       ;       i*(i+4)
      c(0,0,4) =   22658._R_P; c(1,0,4) = -208501._R_P; c(2,0,4) =  364863._R_P; c(3,0,4) = -288007._R_P; c(4,0,4) =   86329._R_P
      !     /                ;    (i+3)*(i+3)         ;      (i+2)*(i+3)       ;      (i+1)*(i+3)       ;       i*(i+3)
      c(0,1,4) =       0._R_P; c(1,1,4) =  482963._R_P; c(2,1,4) =-1704396._R_P; c(3,1,4) = 1358458._R_P; c(4,1,4) = -411487._R_P
      !     /                ;     /                  ;      (i+2)*(i+2)       ;      (i+1)*(i+2)       ;       i*(i+2)
      c(0,2,4) =       0._R_P; c(1,2,4) =       0._R_P; c(2,2,4) = 1521393._R_P; c(3,2,4) =-2462076._R_P; c(4,2,4) =  758823._R_P
      !     /                ;     /                  ;       /                ;      (i+1)*(i+1)       ;       i*(i+1)
      c(0,3,4) =       0._R_P; c(1,3,4) =       0._R_P; c(2,3,4) =       0._R_P; c(3,3,4) = 1020563._R_P; c(4,3,4) = -649501._R_P
      !     /                ;     /                  ;       /                ;       /                ;       i*i
      c(0,4,4) =       0._R_P; c(1,4,4) =       0._R_P; c(2,4,4) =       0._R_P; c(3,4,4) =       0._R_P; c(4,4,4) =  107918._R_P
    case(6) ! 11th order
      ! stencil 0
      !          i*i           ;         (i-1)*i          ;         (i-2)*i          ;        (i-3)*i
      c(0,0,0) =   6150211._R_P; c(1,0,0) = -47460464._R_P; c(2,0,0) =  76206736._R_P; c(3,0,0) = -63394124._R_P
      !        (i-4)*i         ;         (i-5)*i
      c(4,0,0) =  27060160._R_P; c(5,0,0) =  -4712740._R_P

      !          /             ;         (i-1)*(i-1)      ;         (i-2)*(i-1)      ;        (i-3)*(i-1)
      c(0,1,0) =         0._R_P; c(1,1,0) =  94851237._R_P; c(2,1,0) =-311771244._R_P; c(3,1,0) = 262901672._R_P
      !      (i-4)*(i-1)       ;         (i-5)*(i-1)
      c(4,1,0) =-113206788._R_P; c(5,1,0) =  19834350._R_P

      !          /             ;           /              ;         (i-2)*(i-2)      ;        (i-3)*(i-2)
      c(0,2,0) =         0._R_P; c(1,2,0) =         0._R_P; c(2,2,0) = 260445372._R_P; c(3,2,0) =-444003904._R_P
      !      (i-4)*(i-2)       ;         (i-5)*(i-2)
      c(4,2,0) = 192596472._R_P; c(5,2,0) = -33918804._R_P

      !          /             ;           /              ;          /               ;        (i-3)*(i-3)
      c(0,3,0) =         0._R_P; c(1,3,0) =         0._R_P; c(2,3,0) =         0._R_P; c(3,3,0) = 190757572._R_P
      !      (i-4)*(i-3)       ;         (i-5)*(i-3)
      c(4,3,0) =-166461044._R_P; c(5,3,0) =  29442256._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,4,0) =         0._R_P; c(1,4,0) =         0._R_P; c(2,4,0) =         0._R_P; c(3,4,0) =         0._R_P
      !      (i-4)*(i-4)       ;         (i-5)*(i-4)
      c(4,4,0) =  36480687._R_P; c(5,4,0) = -12950184._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,5,0) =         0._R_P; c(1,5,0) =         0._R_P; c(2,5,0) =         0._R_P; c(3,5,0) =         0._R_P
      !       /                ;         (i-5)*(i-5)
      c(4,5,0) =         0._R_P; c(5,5,0) =   1152561._R_P

      ! stencil 1
      !        (i+1)*(i+1)     ;             i*(i+1)      ;         (i-1)*(i+1)      ;        (i-2)*(i+1)
      c(0,0,1) =   1152561._R_P; c(1,0,1) =  -9117992._R_P; c(2,0,1) =  14742480._R_P; c(3,0,1) = -12183636._R_P
      !        (i-3)*(i+1)     ;         (i-4)*(i+1)
      c(4,0,1) =   5134574._R_P; c(5,0,1) =   -880548._R_P

      !          /             ;             i*i          ;         (i-1)*i          ;        (i-2)*i
      c(0,1,1) =         0._R_P; c(1,1,1) =  19365967._R_P; c(2,1,1) = -65224244._R_P; c(3,1,1) =  55053752._R_P
      !      (i-3)*i           ;         (i-4)*i
      c(4,1,1) = -23510468._R_P; c(5,1,1) =   4067018._R_P

      !          /             ;           /              ;         (i-1)*(i-1)      ;        (i-2)*(i-1)
      c(0,2,1) =         0._R_P; c(1,2,1) =         0._R_P; c(2,2,1) =  56662212._R_P; c(3,2,1) = -97838784._R_P
      !      (i-3)*(i-1)       ;         (i-4)*(i-1)
      c(4,2,1) =  42405032._R_P; c(5,2,1) =  -7408908._R_P

      !          /             ;           /              ;          /               ;        (i-2)*(i-2)
      c(0,3,1) =         0._R_P; c(1,3,1) =         0._R_P; c(2,3,1) =         0._R_P; c(3,3,1) =  43093692._R_P
      !      (i-3)*(i-2)       ;         (i-4)*(i-2)
      c(4,3,1) = -37913324._R_P; c(5,3,1) =   6694608._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,4,1) =         0._R_P; c(1,4,1) =         0._R_P; c(2,4,1) =         0._R_P; c(3,4,1) =         0._R_P
      !      (i-3)*(i-3)       ;         (i-4)*(i-3)
      c(4,4,1) =   8449957._R_P; c(5,4,1) =  -3015728._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,5,1) =         0._R_P; c(1,5,1) =         0._R_P; c(2,5,1) =         0._R_P; c(3,5,1) =         0._R_P
      !       /                ;         (i-4)*(i-4)
      c(4,5,1) =         0._R_P; c(5,5,1) =    271779._R_P

      ! stencil 2
      !        (i+2)*(i+2)     ;         (i+1)*(i+2)      ;             i*(i+2)      ;        (i-1)*(i+2)
      c(0,0,2) =    271779._R_P; c(1,0,2) =  -2380800._R_P; c(2,0,2) =   4086352._R_P; c(3,0,2) =  -3462252._R_P
      !        (i-2)*(i+2)     ;         (i-3)*(i+2)
      c(4,0,2) =   1458762._R_P; c(5,0,2) =   -245620._R_P

      !          /             ;         (i+1)*(i+1)      ;             i*(i+1)      ;        (i-1)*(i+1)
      c(0,1,2) =         0._R_P; c(1,1,2) =   5653317._R_P; c(2,1,2) = -20427884._R_P; c(3,1,2) =  17905032._R_P
      !        (i-2)*(i+1)     ;         (i-3)*(i+1)
      c(4,1,2) =  -7727988._R_P; c(5,1,2) =   1325006._R_P

      !          /             ;           /              ;             i*i          ;        (i-1)*i
      c(0,2,2) =         0._R_P; c(1,2,2) =         0._R_P; c(2,2,2) =  19510972._R_P; c(3,2,2) = -35817664._R_P
      !      (i-2)*i           ;         (i-3)*i
      c(4,2,2) =  15929912._R_P; c(5,2,2) =  -2792660._R_P

      !          /             ;           /              ;          /               ;        (i-1)*(i-1)
      c(0,3,2) =         0._R_P; c(1,3,2) =         0._R_P; c(2,3,2) =         0._R_P; c(3,3,2) =  17195652._R_P
      !      (i-2)*(i-1)       ;         (i-3)*(i-1)
      c(4,3,2) = -15880404._R_P; c(5,3,2) =   2863984._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,4,2) =         0._R_P; c(1,4,2) =         0._R_P; c(2,4,2) =         0._R_P; c(3,4,2) =         0._R_P
      !      (i-2)*(i-2)       ;         (i-3)*(i-2)
      c(4,4,2) =   3824847._R_P; c(5,4,2) =  -1429976._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,5,2) =         0._R_P; c(1,5,2) =         0._R_P; c(2,5,2) =         0._R_P; c(3,5,2) =         0._R_P
      !       /                ;         (i-3)*(i-3)
      c(4,5,2) =         0._R_P; c(5,5,2) =    139633._R_P

      ! stencil 3
      !        (i+3)*(i+3)     ;         (i+2)*(i+3)      ;         (i+1)*(i+3)      ;            i*(i+3)
      c(0,0,3) =    139633._R_P; c(1,0,3) =  -1429976._R_P; c(2,0,3) =   2863984._R_P; c(3,0,3) =  -2792660._R_P
      !        (i-1)*(i+3)     ;         (i-2)*(i+3)
      c(4,0,3) =   1325006._R_P; c(5,0,3) =   -245620._R_P

      !          /             ;         (i+2)*(i+2)      ;         (i+1)*(i+2)      ;            i*(i+2)
      c(0,1,3) =         0._R_P; c(1,1,3) =   3824847._R_P; c(2,1,3) = -15880404._R_P; c(3,1,3) =  15929912._R_P
      !        (i-1)*(i+2)     ;         (i-2)*(i+2)
      c(4,1,3) =  -7727988._R_P; c(5,1,3) =   1458762._R_P

      !          /             ;           /              ;         (i+1)*(i+1)      ;            i*(i+1)
      c(0,2,3) =         0._R_P; c(1,2,3) =         0._R_P; c(2,2,3) =  17195652._R_P; c(3,2,3) = -35817664._R_P
      !      (i-1)*(i+1)       ;         (i-2)*(i+1)
      c(4,2,3) =  17905032._R_P; c(5,2,3) =  -3462252._R_P

      !          /             ;           /              ;          /               ;            i*i
      c(0,3,3) =         0._R_P; c(1,3,3) =         0._R_P; c(2,3,3) =         0._R_P; c(3,3,3) =  19510972._R_P
      !      (i-1)*i       ;         (i-2)*i
      c(4,3,3) = -20427884._R_P; c(5,3,3) =   4086352._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,4,3) =         0._R_P; c(1,4,3) =         0._R_P; c(2,4,3) =         0._R_P; c(3,4,3) =         0._R_P
      !      (i-1)*(i-1)       ;         (i-2)*(i-1)
      c(4,4,3) =   5653317._R_P; c(5,4,3) =  -2380800._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,5,3) =         0._R_P; c(1,5,3) =         0._R_P; c(2,5,3) =         0._R_P; c(3,5,3) =         0._R_P
      !       /                ;         (i-2)*(i-2)
      c(4,5,3) =         0._R_P; c(5,5,3) =    271779._R_P

      ! stencil 4
      !        (i+4)*(i+4)     ;         (i+3)*(i+4)      ;         (i+2)*(i+4)      ;        (i+1)*(i+4)
      c(0,0,4) =    271779._R_P; c(1,0,4) =  -3015728._R_P; c(2,0,4) =   6694608._R_P; c(3,0,4) =  -7408908._R_P
      !            i*(i+4)     ;         (i-1)*(i+4)
      c(4,0,4) =   4067018._R_P; c(5,0,4) =   -880548._R_P

      !          /             ;         (i+3)*(i+3)      ;         (i+2)*(i+3)      ;        (i+1)*(i+3)
      c(0,1,4) =         0._R_P; c(1,1,4) =   8449957._R_P; c(2,1,4) = -37913324._R_P; c(3,1,4) =  42405032._R_P
      !           i*(i+3)      ;         (i-1)*(i+3)
      c(4,1,4) = -23510468._R_P; c(5,1,4) =   5134574._R_P

      !          /             ;           /              ;         (i+2)*(i+2)      ;        (i+1)*(i+2)
      c(0,2,4) =         0._R_P; c(1,2,4) =         0._R_P; c(2,2,4) =  43093692._R_P; c(3,2,4) = -97838784._R_P
      !          i*(i+2)       ;         (i-1)*(i+2)
      c(4,2,4) =  55053752._R_P; c(5,2,4) = -12183636._R_P

      !          /             ;           /              ;          /               ;        (i+1)*(i+1)
      c(0,3,4) =         0._R_P; c(1,3,4) =         0._R_P; c(2,3,4) =         0._R_P; c(3,3,4) =  56662212._R_P
      !          i*(i+1)       ;         (i-1)*(i+1)
      c(4,3,4) = -65224244._R_P; c(5,3,4) =  14742480._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,4,4) =         0._R_P; c(1,4,4) =         0._R_P; c(2,4,4) =         0._R_P; c(3,4,4) =         0._R_P
      !          i*i           ;         (i-1)*i
      c(4,4,4) =  19365967._R_P; c(5,4,4) =  -9117992._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,5,4) =         0._R_P; c(1,5,4) =         0._R_P; c(2,5,4) =         0._R_P; c(3,5,4) =         0._R_P
      !       /                ;         (i-1)*(i-1)
      c(4,5,4) =         0._R_P; c(5,5,4) =   1152561._R_P

      ! stencil 5
      !        (i+5)*(i+5)     ;         (i+4)*(i+5)      ;         (i+3)*(i+5)      ;        (i+2)*(i+5)
      c(0,0,5) =   1152561._R_P; c(1,0,5) = -12950184._R_P; c(2,0,5) =  29442256._R_P; c(3,0,5) = -33918804._R_P
      !        (i+1)*(i+5)     ;             i*(i+5)
      c(4,0,5) =  19834350._R_P; c(5,0,5) =  -4712740._R_P

      !          /             ;         (i+4)*(i+4)      ;         (i+3)*(i+4)      ;        (i+2)*(i+4)
      c(0,1,5) =         0._R_P; c(1,1,5) =  36480687._R_P; c(2,1,5) =-166461044._R_P; c(3,1,5) = 192596472._R_P
      !        (i+1)(i+4)      ;             i*(i+4)
      c(4,1,5) =-113206788._R_P; c(5,1,5) =  27060170._R_P

      !          /             ;           /              ;         (i+3)*(i+3)      ;        (i+2)*(i+3)
      c(0,2,5) =         0._R_P; c(1,2,5) =         0._R_P; c(2,2,5) = 190757572._R_P; c(3,2,5) =-444003904._R_P
      !      (i+1)*(i+3)       ;             i*(i+3)
      c(4,2,5) = 262901672._R_P; c(5,2,5) = -63394124._R_P

      !          /             ;           /              ;          /               ;        (i+2)*(i+2)
      c(0,3,5) =         0._R_P; c(1,3,5) =         0._R_P; c(2,3,5) =         0._R_P; c(3,3,5) = 260445372._R_P
      !      (i+1)*(i+2)       ;             i*(i+2)
      c(4,3,5) =-311771244._R_P; c(5,3,5) =  76206736._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,4,5) =         0._R_P; c(1,4,5) =         0._R_P; c(2,4,5) =         0._R_P; c(3,4,5) =         0._R_P
      !      (i+1)*(i+1)       ;             i*(i+1)
      c(4,4,5) =  94851237._R_P; c(5,4,5) = -47460464._R_P

      !          /             ;           /              ;          /               ;         /
      c(0,5,5) =         0._R_P; c(1,5,5) =         0._R_P; c(2,5,5) =         0._R_P; c(3,5,5) =         0._R_P
      !       /                ;             i*i
      c(4,5,5) =         0._R_P; c(5,5,5) =   6150211._R_P
    case(7) ! 13th order
      ! stencil 0
      !                   i*i                   ;                   (i-1)*i
      c(0,0,0) =     897207163._R_P/7484400._R_P; c(1,0,0) = -22763092357._R_P/19958400._R_P
      !                  (i-2)*i                ;                   (i-3)*i
      c(2,0,0) =  46808583631._R_P/19958400._R_P; c(3,0,0) = -39645439643._R_P/14968800._R_P
      !                  (i-4)*i                ;                   (i-5)*i
      c(4,0,0) =    8579309749._R_P/4989600._R_P; c(5,0,0) =   -2416885043._R_P/3991680._R_P
      !                  (i-6)*i
      c(6,0,0) =   5391528799._R_P/59875200._R_P

      !                    /                    ;                   (i-1)*(i-1)
      c(0,1,0) =                          0._R_P; c(1,1,0) =    6182612731._R_P/2217600._R_P
      !                  (i-2)*(i-1)            ;                   (i-3)*(i-1)
      c(2,1,0) =    -8623431623._R_P/739200._R_P; c(3,1,0) =   66440049371._R_P/4989600._R_P
      !                  (i-4)*(i-1)            ;                   (i-5)*(i-1)
      c(4,1,0) =  -19308505679._R_P/2217600._R_P; c(5,1,0) =    3417057367._R_P/1108800._R_P
      !                  (i-6)*(i-1)
      c(6,1,0) =  -9181961959._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,2,0) =                          0._R_P; c(1,2,0) =                          0._R_P
      !                  (i-2)*(i-2)            ;                   (i-3)*(i-2)
      c(2,2,0) =     1369404749._R_P/110880._R_P; c(3,2,0) =   -28364892607._R_P/997920._R_P
      !                  (i-4)*(i-2)            ;                   (i-5)*(i-2)
      c(4,2,0) =     8290771913._R_P/443520._R_P; c(5,2,0) =  -14734178999._R_P/2217600._R_P
      !                  (i-6)*(i-2)
      c(6,2,0) =    4964771899._R_P/4989600._R_P

      !                    /                    ;                     /
      c(0,3,0) =                          0._R_P; c(1,3,0) =                          0._R_P
      !                    /                    ;                   (i-3)*(i-3)
      c(2,3,0) =                          0._R_P; c(3,3,0) =   49256859919._R_P/2993760._R_P
      !                  (i-4)*(i-3)            ;                   (i-5)*(i-3)
      c(4,3,0) =   -21693002767._R_P/997920._R_P; c(5,3,0) =   38683385051._R_P/4989600._R_P
      !                  (i-6)*(i-3)
      c(6,3,0) = -17425032203._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,0) =                          0._R_P; c(1,4,0) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,0) =                          0._R_P; c(3,4,0) =                          0._R_P
      !                  (i-4)*(i-4)            ;                   (i-5)*(i-4)
      c(4,4,0) =       199730921._R_P/27720._R_P; c(5,4,0) =    -3809437823._R_P/739200._R_P
      !                  (i-6)*(i-4)
      c(6,4,0) =  15476926351._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,5,0) =                          0._R_P; c(1,5,0) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,0) =                          0._R_P; c(3,5,0) =                          0._R_P
      !                    /                    ;                   (i-5)*(i-5)
      c(4,5,0) =                          0._R_P; c(5,5,0) =    2047941883._R_P/2217600._R_P
      !                  (i-6)*(i-5)
      c(6,5,0) = -5556669277._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,6,0) =                          0._R_P; c(1,6,0) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,0) =                          0._R_P; c(3,6,0) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,0) =                          0._R_P; c(5,6,0) =                          0._R_P
      !                  (i-6)*(i-6)
      c(6,6,0) =      62911297._R_P/2993760._R_P
      ! stencil 1
      !                  (i+1)*(i+1)            ;                    i*(i+1)
      c(0,0,1) =      62911297._R_P/2993760._R_P; c(1,0,1) =  -4074544787._R_P/19958400._R_P
      !                  (i-1)*(i+1)            ;                   (i-2)*(i+1)
      c(2,0,1) =    2811067067._R_P/6652800._R_P; c(3,0,1) =  -7124638253._R_P/14968800._R_P
      !                  (i-3)*(i+1)            ;                   (i-4)*(i+1)
      c(4,0,1) =    1531307249._R_P/4989600._R_P; c(5,0,1) =    -712745603._R_P/6652800._R_P
      !                  (i-5)*(i+1)
      c(6,0,1) =    945166329._R_P/59875200._R_P

      !                    /                    ;                       i*(i-1)
      c(0,1,1) =                          0._R_P; c(1,1,1) =       12742497._R_P/246400._R_P
      !                  (i-1)*(i-1)            ;                   (i-2)*(i-1)
      c(2,1,1) =  -14684933057._R_P/6652800._R_P; c(3,1,1) =   12601009501._R_P/4989600._R_P
      !                  (i-3)*(i-1)            ;                   (i-4)*(i-1)
      c(4,1,1) =     -405382961._R_P/246400._R_P; c(5,1,1) =    1924032511._R_P/3326400._R_P
      !                  (i-5)*(i-1)
      c(6,1,1) =    -341910757._R_P/3991680._R_P

      !                    /                    ;                    /
      c(0,2,1) =                          0._R_P; c(1,2,1) =                          0._R_P
      !                  (i-1)*(i-2)            ;                   (i-3)*(i-2)
      c(2,2,1) =      796358777._R_P/332640._R_P; c(3,2,1) =     -616410313._R_P/110880._R_P
      !                  (i-4)*(i-2)            ;                   (i-5)*(i-2)
      c(4,2,1) =    4868089189._R_P/1330560._R_P; c(5,2,1) =   -8619440987._R_P/6652800._R_P
      !                  (i-6)*(i-2)
      c(6,2,1) =     320782183._R_P/1663200._R_P

      !                    /                    ;                     /
      c(0,3,1) =                          0._R_P; c(1,3,1) =                          0._R_P
      !                    /                    ;                   (i-2)*(i-3)
      c(2,3,1) =                          0._R_P; c(3,3,1) =    9780057169._R_P/2993760._R_P
      !                  (i-3)*(i-3)            ;                   (i-4)*(i-3)
      c(4,3,1) =    -4330640057._R_P/997920._R_P; c(5,3,1) =      857838469._R_P/554400._R_P
      !                  (i-5)*(i-3)
      c(6,3,1) =  -3465607493._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,1) =                          0._R_P; c(1,4,1) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,1) =                          0._R_P; c(3,4,1) =                          0._R_P
      !                  (i-3)*(i-4)            ;                   (i-4)*(i-4)
      c(4,4,1) =        53678683._R_P/36960._R_P; c(5,4,1) =   -6932480657._R_P/6652800._R_P
      !                  (i-5)*(i-4)
      c(6,4,1) =  3126718481._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,5,1) =                          0._R_P; c(1,5,1) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,1) =                          0._R_P; c(3,5,1) =                          0._R_P
      !                    /                    ;                   (i-5)*(i-5)
      c(4,5,1) =                          0._R_P; c(5,5,1) =    1250007643._R_P/6652800._R_P
      !                  (i-6)*(i-5)
      c(6,5,1) =    -377474689._R_P/6652800._R_P

      !                    /                    ;                     /
      c(0,6,1) =                          0._R_P; c(1,6,1) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,1) =                          0._R_P; c(3,6,1) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,1) =                          0._R_P; c(5,6,1) =                          0._R_P
      !                  (i-6)*(i-5)
      c(6,6,1) =     64361771._R_P/14968800._R_P
      ! stencil 2
      !                  (i+2)*i                ;                   (i+1)*i
      c(0,0,2) =     64361771._R_P/14968800._R_P; c(1,0,2) =   -295455983._R_P/6652800._R_P
      !                      i*i                ;                   (i-1)*i
      c(2,0,2) =   1894705391._R_P/19958400._R_P; c(3,0,2) = -1618284323._R_P/14968800._R_P
      !                  (i-2)*i                ;                   (i-3)*i
      c(4,0,2) =     115524053._R_P/1663200._R_P; c(5,0,2) =    -95508139._R_P/3991680._R_P
      !                  (i-4)*i
      c(6,0,2) =       8279479._R_P/2395008._R_P

      !                    /                    ;                   (i+1)*(i-1)
      c(0,1,2) =                          0._R_P; c(1,1,2) =     806338417._R_P/6652800._R_P
      !                      i*(i-1)            ;                   (i-1)*(i-1)
      c(2,1,2) =   -3573798407._R_P/6652800._R_P; c(3,1,2) =    1042531337._R_P/1663200._R_P
      !                  (i-2)*(i-1)            ;                   (i-3)*(i-1)
      c(4,1,2) =   -2725575317._R_P/6652800._R_P; c(5,1,2) =     475321093._R_P/3326400._R_P
      !                  (i-4)*(i-1)
      c(6,1,2) =      -15401629._R_P/739200._R_P

      !                    /                    ;                    /
      c(0,2,2) =                          0._R_P; c(1,2,2) =                          0._R_P
          !                  i*(i-1)            ;                   (i-1)*(i-2)
      c(2,2,2) =        34187317._R_P/55440._R_P; c(3,2,2) =    -1476618887._R_P/997920._R_P
      !                  (i-2)*(i-2)            ;                   (i-3)*(i-2)
      c(4,2,2) =    1312114459._R_P/1330560._R_P; c(5,2,2) =    -773749439._R_P/2217600._R_P
      !                  (i-4)*(i-2)
      c(6,2,2) =     256556849._R_P/4989600._R_P

      !                    /                    ;                     /
      c(0,3,2) =                          0._R_P; c(1,3,2) =                          0._R_P
      !                    /                    ;                   (i-1)*(i-3)
      c(2,3,2) =                          0._R_P; c(3,3,2) =    2726585359._R_P/2993760._R_P
      !                  (i-2)*(i-3)            ;                   (i-3)*(i-3)
      c(4,3,2) =     -412424029._R_P/332640._R_P; c(5,3,2) =    2224538011._R_P/4989600._R_P
      !                  (i-4)*(i-3)
      c(6,3,2) =   -995600723._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,2) =                          0._R_P; c(1,4,2) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,2) =                          0._R_P; c(3,4,2) =                          0._R_P
      !                  (i-2)*(i-4)            ;                   (i-3)*(i-4)
      c(4,4,2) =      143270957._R_P/332640._R_P; c(5,4,2) =   -2096571887._R_P/6652800._R_P
      !                  (i-4)*(i-4)
      c(6,4,2) =     105706999._R_P/2217600._R_P

      !                    /                    ;                     /
      c(0,5,2) =                          0._R_P; c(1,5,2) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,2) =                          0._R_P; c(3,5,2) =                          0._R_P
      !                    /                    ;                   (i-3)*(i-5)
      c(4,5,2) =                          0._R_P; c(5,5,2) =     130013563._R_P/2217600._R_P
      !                  (i-4)*(i-5)
      c(6,5,2) =   -359321429._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,6,2) =                          0._R_P; c(1,6,2) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,2) =                          0._R_P; c(3,6,2) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,2) =                          0._R_P; c(5,6,2) =                          0._R_P
      !                  (i-4)*(i-5)
      c(6,6,2) =       2627203._R_P/1871100._R_P
      ! stencil 3
      !                  (i+3)*i                ;                   (i+2)*i
      c(0,0,3) =       2627203._R_P/1871100._R_P; c(1,0,3) =  -323333323._R_P/19958400._R_P
      !                  (i+1)*i                ;                       i*i
      c(2,0,3) =    761142961._R_P/19958400._R_P; c(3,0,3) =  -701563133._R_P/14968800._R_P
      !                  (i-1)*i                ;                   (i-2)*i
      c(4,0,3) =     158544319._R_P/4989600._R_P; c(5,0,3) =  -225623953._R_P/19958400._R_P
      !                  (i-3)*i
      c(6,0,3) =     99022657._R_P/59875200._R_P

      !                    /                    ;                   (i+1)*(i-1)
      c(0,1,3) =                          0._R_P; c(1,1,3) =     108444169._R_P/2217600._R_P
      !                      i*(i-1)            ;                   (i-1)*(i-1)
      c(2,1,3) =     -176498513._R_P/739200._R_P; c(3,1,3) =    1506944981._R_P/4989600._R_P
      !                  (i-2)*(i-1)            ;                   (i-3)*(i-1)
      c(4,1,3) =    -464678369._R_P/2217600._R_P; c(5,1,3) =      84263749._R_P/1108800._R_P
      !                  (i-4)*(i-1)
      c(6,1,3) =   -225623953._R_P/19958400._R_P

      !                    /                    ;                    /
      c(0,2,3) =                          0._R_P; c(1,2,3) =                          0._R_P
          !                  i*(i-1)            ;                   (i-1)*(i-2)
      c(2,2,3) =        16790707._R_P/55440._R_P; c(3,2,3) =     -790531177._R_P/997920._R_P
      !                  (i-2)*(i-2)            ;                   (i-3)*(i-2)
      c(4,2,3) =      250523543._R_P/443520._R_P; c(5,2,3) =    -464678369._R_P/2217600._R_P
      !                  (i-4)*(i-2)
      c(6,2,3) =     158544319._R_P/4989600._R_P

      !                    /                    ;                     /
      c(0,3,3) =                          0._R_P; c(1,3,3) =                          0._R_P
      !                    /                    ;                   (i-1)*(i-3)
      c(2,3,3) =                          0._R_P; c(3,3,3) =    1607739169._R_P/2993760._R_P
      !                  (i-2)*(i-3)            ;                   (i-3)*(i-3)
      c(4,3,3) =     -790531177._R_P/997920._R_P; c(5,3,3) =    1506944981._R_P/4989600._R_P
      !                  (i-4)*(i-3)
      c(6,3,3) =   -701563133._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,3) =                          0._R_P; c(1,4,3) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,3) =                          0._R_P; c(3,4,3) =                          0._R_P
      !                  (i-2)*(i-4)            ;                   (i-3)*(i-4)
      c(4,4,3) =        16790707._R_P/55440._R_P; c(5,4,3) =     -176498513._R_P/739200._R_P
      !                  (i-4)*(i-4)
      c(6,4,3) =    761142961._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,5,3) =                          0._R_P; c(1,5,3) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,3) =                          0._R_P; c(3,5,3) =                          0._R_P
      !                    /                    ;                   (i-3)*(i-5)
      c(4,5,3) =                          0._R_P; c(5,5,3) =     108444169._R_P/2217600._R_P
      !                  (i-4)*(i-5)
      c(6,5,3) =   -323333323._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,6,3) =                          0._R_P; c(1,6,3) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,3) =                          0._R_P; c(3,6,3) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,3) =                          0._R_P; c(5,6,3) =                          0._R_P
      !                  (i-4)*(i-5)
      c(6,6,3) =       2627203._R_P/1871100._R_P
      ! stencil 4
      !                  (i+3)*i                ;                   (i+2)*i
      c(0,0,4) =       2627203._R_P/1871100._R_P; c(1,0,4) =  -359321429._R_P/19958400._R_P
      !                  (i+1)*i                ;                       i*i
      c(2,0,4) =     105706999._R_P/2217600._R_P; c(3,0,4) =  -995600723._R_P/14968800._R_P
      !                  (i-1)*i                ;                   (i-2)*i
      c(4,0,4) =     256556849._R_P/4989600._R_P; c(5,0,4) =     -15401629._R_P/739200._R_P
      !                  (i-3)*i
      c(6,0,4) =       8279479._R_P/2395008._R_P

      !                    /                    ;                   (i+1)*(i-1)
      c(0,1,4) =                          0._R_P; c(1,1,4) =     130013563._R_P/2217600._R_P
      !                      i*(i-1)            ;                   (i-1)*(i-1)
      c(2,1,4) =   -2096571887._R_P/6652800._R_P; c(3,1,4) =    2224538011._R_P/4989600._R_P
      !                  (i-2)*(i-1)            ;                   (i-3)*(i-1)
      c(4,1,4) =    -773749439._R_P/2217600._R_P; c(5,1,4) =     475321093._R_P/3326400._R_P
      !                  (i-4)*(i-1)
      c(6,1,4) =     -95508139._R_P/3991680._R_P

      !                    /                    ;                    /
      c(0,2,4) =                          0._R_P; c(1,2,4) =                          0._R_P
          !                  i*(i-1)            ;                   (i-1)*(i-2)
      c(2,2,4) =      143270957._R_P/332640._R_P; c(3,2,4) =     -412424029._R_P/332640._R_P
      !                  (i-2)*(i-2)            ;                   (i-3)*(i-2)
      c(4,2,4) =    1312114459._R_P/1330560._R_P; c(5,2,4) =   -2725575317._R_P/6652800._R_P
      !                  (i-4)*(i-2)
      c(6,2,4) =     115524053._R_P/1663200._R_P

      !                    /                    ;                     /
      c(0,3,4) =                          0._R_P; c(1,3,4) =                          0._R_P
      !                    /                    ;                   (i-1)*(i-3)
      c(2,3,4) =                          0._R_P; c(3,3,4) =    2726585359._R_P/2993760._R_P
      !                  (i-2)*(i-3)            ;                   (i-3)*(i-3)
      c(4,3,4) =    -1476618887._R_P/997920._R_P; c(5,3,4) =    1042531337._R_P/1663200._R_P
      !                  (i-4)*(i-3)
      c(6,3,4) =  -1618284323._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,4) =                          0._R_P; c(1,4,4) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,4) =                          0._R_P; c(3,4,4) =                          0._R_P
      !                  (i-2)*(i-4)            ;                   (i-3)*(i-4)
      c(4,4,4) =        34187317._R_P/55440._R_P; c(5,4,4) =   -3573798407._R_P/6652800._R_P
      !                  (i-4)*(i-4)
      c(6,4,4) =   1894705391._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,5,4) =                          0._R_P; c(1,5,4) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,4) =                          0._R_P; c(3,5,4) =                          0._R_P
      !                    /                    ;                   (i-3)*(i-5)
      c(4,5,4) =                          0._R_P; c(5,5,4) =     806338417._R_P/6652800._R_P
      !                  (i-4)*(i-5)
      c(6,5,4) =    -295455983._R_P/6652800._R_P

      !                    /                    ;                     /
      c(0,6,4) =                          0._R_P; c(1,6,4) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,4) =                          0._R_P; c(3,6,4) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,4) =                          0._R_P; c(5,6,4) =                          0._R_P
      !                  (i-4)*(i-5)
      c(6,6,4) =     64361771._R_P/14968800._R_P
      ! stencil 5
      !                  (i+3)*i                ;                   (i+2)*i
      c(0,0,5) =     64361771._R_P/14968800._R_P; c(1,0,5) =    -377474689._R_P/6652800._R_P
      !                  (i+1)*i                ;                       i*i
      c(2,0,5) =   3126718481._R_P/19958400._R_P; c(3,0,5) =  -3465607493._R_P/14968800._R_P
      !                  (i-1)*i                ;                   (i-2)*i
      c(4,0,5) =     320782183._R_P/1663200._R_P; c(5,0,5) =    -341910757._R_P/3991680._R_P
      !                  (i-3)*i
      c(6,0,5) =    945155329._R_P/59875200._R_P

      !                    /                    ;                   (i+1)*(i-1)
      c(0,1,5) =                          0._R_P; c(1,1,5) =    1250007643._R_P/6652800._R_P
      !                      i*(i-1)            ;                   (i-1)*(i-1)
      c(2,1,5) =   -6932480657._R_P/6652800._R_P; c(3,1,5) =      857838469._R_P/554400._R_P
      !                  (i-2)*(i-1)            ;                   (i-3)*(i-1)
      c(4,1,5) =   -8619440987._R_P/6652800._R_P; c(5,1,5) =    1924032511._R_P/3326400._R_P
      !                  (i-4)*(i-1)
      c(6,1,5) =    -712745603._R_P/6652800._R_P

      !                    /                    ;                    /
      c(0,2,5) =                          0._R_P; c(1,2,5) =                          0._R_P
          !                  i*(i-1)            ;                   (i-1)*(i-2)
      c(2,2,5) =        53678683._R_P/36960._R_P; c(3,2,5) =    -4330640057._R_P/997920._R_P
      !                  (i-2)*(i-2)            ;                   (i-3)*(i-2)
      c(4,2,5) =    4868089189._R_P/1330560._R_P; c(5,2,5) =     -405382961._R_P/246400._R_P
      !                  (i-4)*(i-2)
      c(6,2,5) =    1531307249._R_P/4989600._R_P

      !                    /                    ;                     /
      c(0,3,5) =                          0._R_P; c(1,3,5) =                          0._R_P
      !                    /                    ;                   (i-1)*(i-3)
      c(2,3,5) =                          0._R_P; c(3,3,5) =    9780057169._R_P/2993760._R_P
      !                  (i-2)*(i-3)            ;                   (i-3)*(i-3)
      c(4,3,5) =     -616410313._R_P/110880._R_P; c(5,3,5) =   12601009501._R_P/4989600._R_P
      !                  (i-4)*(i-3)
      c(6,3,5) =  -7124638253._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,5) =                          0._R_P; c(1,4,5) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,5) =                          0._R_P; c(3,4,5) =                          0._R_P
      !                  (i-2)*(i-4)            ;                   (i-3)*(i-4)
      c(4,4,5) =      796358777._R_P/332640._R_P; c(5,4,5) =  -14684933057._R_P/6652800._R_P
      !                  (i-4)*(i-4)
      c(6,4,5) =    2811067067._R_P/6652800._R_P

      !                    /                    ;                     /
      c(0,5,5) =                          0._R_P; c(1,5,5) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,5) =                          0._R_P; c(3,5,5) =                          0._R_P
      !                    /                    ;                   (i-3)*(i-5)
      c(4,5,5) =                          0._R_P; c(5,5,5) =      127942497._R_P/246400._R_P
      !                  (i-4)*(i-5)
      c(6,5,5) =  -4074544787._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,6,5) =                          0._R_P; c(1,6,5) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,5) =                          0._R_P; c(3,6,5) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,5) =                          0._R_P; c(5,6,5) =                          0._R_P
      !                  (i-4)*(i-5)
      c(6,6,5) =      62911297._R_P/2993760._R_P
      ! stencil 6
      !                  (i+3)*i                ;                   (i+2)*i
      c(0,0,6) =      62911297._R_P/2993760._R_P; c(1,0,6) =  -5556669277._R_P/19958400._R_P
      !                  (i+1)*i                ;                       i*i
      c(2,0,6) =  15476926351._R_P/19958400._R_P; c(3,0,6) = -17425032203._R_P/14968800._R_P
      !                  (i-1)*i                ;                   (i-2)*i
      c(4,0,6) =    4964771899._R_P/4989600._R_P; c(5,0,6) =  -9181961959._R_P/19958400._R_P
      !                  (i-3)*i
      c(6,0,6) =   5391528799._R_P/59875200._R_P

      !                    /                    ;                   (i+1)*(i-1)
      c(0,1,6) =                          0._R_P; c(1,1,6) =    2047941883._R_P/2217600._R_P
      !                      i*(i-1)            ;                   (i-1)*(i-1)
      c(2,1,6) =    -3809437823._R_P/739200._R_P; c(3,1,6) =   38683385051._R_P/4989600._R_P
      !                  (i-2)*(i-1)            ;                   (i-3)*(i-1)
      c(4,1,6) =  -14734178999._R_P/2217600._R_P; c(5,1,6) =    3417057367._R_P/1108800._R_P
      !                  (i-4)*(i-1)
      c(6,1,6) =   -2416885043._R_P/3991680._R_P

      !                    /                    ;                    /
      c(0,2,6) =                          0._R_P; c(1,2,6) =                          0._R_P
          !                  i*(i-1)            ;                   (i-1)*(i-2)
      c(2,2,6) =       199730921._R_P/27720._R_P; c(3,2,6) =   -21693002767._R_P/997920._R_P
      !                  (i-2)*(i-2)            ;                   (i-3)*(i-2)
      c(4,2,6) =     8290771913._R_P/443520._R_P; c(5,2,6) =   -19308505679._R_P/2217600._R_P
      !                  (i-4)*(i-2)
      c(6,2,6) =    8579309749._R_P/4989600._R_P

      !                    /                    ;                     /
      c(0,3,6) =                          0._R_P; c(1,3,6) =                          0._R_P
      !                    /                    ;                   (i-1)*(i-3)
      c(2,3,6) =                          0._R_P; c(3,3,6) =   49256859919._R_P/2993760._R_P
      !                  (i-2)*(i-3)            ;                   (i-3)*(i-3)
      c(4,3,6) =   -28364892607._R_P/997920._R_P; c(5,3,6) =   66440049371._R_P/4989600._R_P
      !                  (i-4)*(i-3)
      c(6,3,6) = -39645439643._R_P/14968800._R_P

      !                    /                    ;                     /
      c(0,4,6) =                          0._R_P; c(1,4,6) =                          0._R_P
      !                    /                    ;                     /
      c(2,4,6) =                          0._R_P; c(3,4,6) =                          0._R_P
      !                  (i-2)*(i-4)            ;                   (i-3)*(i-4)
      c(4,4,6) =     1369404749._R_P/110880._R_P; c(5,4,6) =    -8623431623._R_P/739200._R_P
      !                  (i-4)*(i-4)
      c(6,4,6) =  46808583631._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,5,6) =                          0._R_P; c(1,5,6) =                          0._R_P
      !                    /                    ;                     /
      c(2,5,6) =                          0._R_P; c(3,5,6) =                          0._R_P
      !                    /                    ;                   (i-3)*(i-5)
      c(4,5,6) =                          0._R_P; c(5,5,6) =    6182612731._R_P/2217600._R_P
      !                  (i-4)*(i-5)
      c(6,5,6) = -22763092357._R_P/19958400._R_P

      !                    /                    ;                     /
      c(0,6,6) =                          0._R_P; c(1,6,6) =                          0._R_P
      !                    /                    ;                     /
      c(2,6,6) =                          0._R_P; c(3,6,6) =                          0._R_P
      !                    /                    ;                     /
      c(4,6,6) =                          0._R_P; c(5,6,6) =                          0._R_P
      !                  (i-4)*(i-5)
      c(6,6,6) =     897207163._R_P/7484400._R_P
    endselect
  endassociate
  return
  !---------------------------------------------------------------------------------------------------------------------------------
  endsubroutine create

  pure subroutine description(self, string)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Return a string describing WENO smoothness indicator.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(weno_IS_js),                intent(in)  :: self   !< WENO alpha coefficient.
  character(len=:), allocatable,    intent(out) :: string !< String returned.
  character(len=1), parameter                   :: nl=new_line('a')  !< New line character.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  string = 'WENO smoothness indicators'//nl
  string = string//'  Based on the work by Jiang and Shu "Efficient Implementation of Weighted ENO Schemes", see '// &
           'JCP, 1996, vol. 126, pp. 202--228, doi:10.1006/jcph.1996.0130'//nl
  string = string//'  The "compute" method has the following public API'//nl
  string = string//'    IS(smooth_coef,v1,v2)'//nl
  string = string//'  where:'//nl
  string = string//'    smooth_coef: real(R_P), intent(IN), the smoothness indicator coefficient of the value'//nl
  string = string//'    v1: real(R_P), intent(IN), the pivotal value from the stencil'//nl
  string = string//'    v2: real(R_P), intent(IN), the second value from the stencil'
  !---------------------------------------------------------------------------------------------------------------------------------
  endsubroutine description

  pure function compute(self, smooth_coef, v1, v2) result(IS)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Compute the partial value of the smoothness indicator of a single WENO interpolating polynomial.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(weno_IS_js), intent(in) :: self        !< WENO alpha coefficient.
  real(R_P),         intent(in) :: smooth_coef !< Coefficient of the smoothness indicator.
  real(R_P),         intent(IN) :: v1          !< First (pivotal) value from the stencil used for the interpolation.
  real(R_P),         intent(IN) :: v2          !< Second value from the stencil used for the interpolation.
  real(R_P),                    :: IS          !< Partial value of the smoothness indicator of polynomial.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  IS = smooth_coef * v1 * v2
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction compute

!-----------------------------------------------------------------------------------------------------------------------------------
endmodule type_weno_smoothness_indicators_js
